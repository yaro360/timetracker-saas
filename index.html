<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>TimeTracker - Multi-Company Platform</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            -webkit-text-size-adjust: 100%;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
        }

        .login-card {
            max-width: 400px;
            margin: 50px auto;
        }

        .logo {
            width: 60px;
            height: 60px;
            background: #4F46E5;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin: 0 auto 20px;
            font-size: 24px;
            font-weight: bold;
        }

        h1 {
            text-align: center;
            color: #1F2937;
            margin-bottom: 10px;
            font-size: 2rem;
            font-weight: 700;
        }

        h2 {
            color: #1F2937;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 600;
        }

        p {
            color: #6B7280;
            line-height: 1.6;
        }

        .subtitle {
            text-align: center;
            color: #6B7280;
            margin-bottom: 30px;
            font-size: 1rem;
        }

        .form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-weight: 500;
            color: #374151;
            font-size: 0.875rem;
        }

        .form-group input,
        .form-group select {
            padding: 12px 16px;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.2s;
            background: white;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4F46E5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            min-height: 44px;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-primary {
            background: #4F46E5;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #4338CA;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }

        .btn-outline {
            background: transparent;
            color: #4F46E5;
            border: 2px solid #4F46E5;
        }

        .btn-outline:hover:not(:disabled) {
            background: #4F46E5;
            color: white;
        }

        .tab-container {
            display: flex;
            background: #F3F4F6;
            border-radius: 8px;
            padding: 4px;
            margin-bottom: 20px;
        }

        .tab {
            flex: 1;
            padding: 12px 16px;
            background: transparent;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            color: #6B7280;
        }

        .tab.active {
            background: white;
            color: #4F46E5;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .demo-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #E5E7EB;
        }

        .demo-label {
            font-size: 0.875rem;
            color: #6B7280;
            margin-bottom: 10px;
            text-align: center;
        }

        .demo-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn-demo {
            background: #F3F4F6;
            color: #374151;
            border: 1px solid #D1D5DB;
            font-size: 0.875rem;
            padding: 8px 16px;
        }

        .btn-demo:hover {
            background: #E5E7EB;
        }

        .loading {
            text-align: center;
            color: white;
            font-size: 1.2rem;
            padding: 40px;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="loading">Loading TimeTracker...</div>
    </div>
    
    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;
        const { createRoot } = ReactDOM;

        // Data Backup and Persistence System
        const DataBackup = {
            // Save data to multiple storage locations
            saveData: (key, data) => {
                try {
                    // Primary storage: localStorage
                    localStorage.setItem(key, JSON.stringify(data));
                    
                    // Secondary storage: sessionStorage
                    sessionStorage.setItem(key, JSON.stringify(data));
                    
                    // Tertiary storage: IndexedDB (if available)
                    if ('indexedDB' in window) {
                        DataBackup.saveToIndexedDB(key, data);
                    }
                    
                    // Cloud backup: Save to remote server (you'll need to implement this)
                    DataBackup.saveToCloud(key, data);
                    
                    console.log(`Data backed up successfully: ${key}`);
                } catch (error) {
                    console.error('Error saving data:', error);
                }
            },
            
            // Load data from multiple storage locations
            loadData: (key) => {
                try {
                    // Try localStorage first
                    let data = localStorage.getItem(key);
                    if (data) {
                        return JSON.parse(data);
                    }
                    
                    // Try sessionStorage
                    data = sessionStorage.getItem(key);
                    if (data) {
                        return JSON.parse(data);
                    }
                    
                    // Try IndexedDB
                    if ('indexedDB' in window) {
                        return DataBackup.loadFromIndexedDB(key);
                    }
                    
                    return null;
                } catch (error) {
                    console.error('Error loading data:', error);
                    return null;
                }
            },
            
            // IndexedDB operations
            saveToIndexedDB: (key, data) => {
                const request = indexedDB.open('TimeTrackerDB', 1);
                request.onupgradeneeded = (event) => {
                    const db = event.target.result;
                    if (!db.objectStoreNames.contains('data')) {
                        db.createObjectStore('data');
                    }
                };
                request.onsuccess = (event) => {
                    const db = event.target.result;
                    const transaction = db.transaction(['data'], 'readwrite');
                    const store = transaction.objectStore('data');
                    store.put(data, key);
                };
            },
            
            loadFromIndexedDB: (key) => {
                return new Promise((resolve) => {
                    const request = indexedDB.open('TimeTrackerDB', 1);
                    request.onsuccess = (event) => {
                        const db = event.target.result;
                        const transaction = db.transaction(['data'], 'readonly');
                        const store = transaction.objectStore('data');
                        const getRequest = store.get(key);
                        getRequest.onsuccess = () => {
                            resolve(getRequest.result);
                        };
                        getRequest.onerror = () => {
                            resolve(null);
                        };
                    };
                    request.onerror = () => {
                        resolve(null);
                    };
                });
            },
            
            // Cloud backup (you'll need to implement your own endpoint)
            saveToCloud: (key, data) => {
                // This is a placeholder - you'll need to implement your own cloud storage
                // Options: Firebase, AWS S3, Google Drive API, Dropbox API, etc.
                try {
                    // Example: Save to a simple JSON file on your server
                    fetch('/api/backup', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            key: key,
                            data: data,
                            timestamp: new Date().toISOString(),
                            userId: 'current-user-id' // You'll need to get this from auth
                        })
                    }).catch(error => {
                        console.log('Cloud backup failed (this is normal if no server is configured):', error);
                    });
                } catch (error) {
                    console.log('Cloud backup not configured:', error);
                }
            },
            
            // Export all data for manual backup
            exportAllData: () => {
                const allData = {
                    users: DataBackup.loadData('users') || [],
                    companies: DataBackup.loadData('companies') || [],
                    timeEntries: DataBackup.loadData('timeEntries') || [],
                    jobSites: DataBackup.loadData('jobSites') || [],
                    exportDate: new Date().toISOString(),
                    version: '1.0'
                };
                
                const dataStr = JSON.stringify(allData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = `timetracker-backup-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                URL.revokeObjectURL(url);
            },
            
            // Import data from backup file
            importData: (file) => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = JSON.parse(e.target.result);
                            
                            // Validate backup format
                            if (!data.version || !data.exportDate) {
                                throw new Error('Invalid backup file format');
                            }
                            
                            // Import each data type
                            if (data.users) DataBackup.saveData('users', data.users);
                            if (data.companies) DataBackup.saveData('companies', data.companies);
                            if (data.timeEntries) DataBackup.saveData('timeEntries', data.timeEntries);
                            if (data.jobSites) DataBackup.saveData('jobSites', data.jobSites);
                            
                            resolve('Data imported successfully!');
                        } catch (error) {
                            reject('Error importing data: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                });
            },
            
            // Automatic backup every 5 minutes
            startAutoBackup: () => {
                setInterval(() => {
                    const users = DataBackup.loadData('users');
                    const companies = DataBackup.loadData('companies');
                    const timeEntries = DataBackup.loadData('timeEntries');
                    const jobSites = DataBackup.loadData('jobSites');
                    
                    if (users || companies || timeEntries || jobSites) {
                        DataBackup.saveData('autoBackup', {
                            users: users || [],
                            companies: companies || [],
                            timeEntries: timeEntries || [],
                            jobSites: jobSites || [],
                            timestamp: new Date().toISOString()
                        });
                    }
                }, 5 * 60 * 1000); // 5 minutes
            }
        };

        // Auth Context
        const AuthContext = createContext();

        const useAuth = () => {
            const context = useContext(AuthContext);
            if (!context) {
                throw new Error('useAuth must be used within an AuthProvider');
            }
            return context;
        };

        const AuthProvider = ({ children }) => {
            const [user, setUser] = useState(null);

            const login = (username, password) => {
                try {
                    const users = DataBackup.loadData('users') || [];
                    const foundUser = users.find(u => u.username === username && u.password === password);
                    
                    if (foundUser) {
                        const userData = { ...foundUser };
                        delete userData.password;
                        setUser(userData);
                        DataBackup.saveData('currentUser', userData);
                        return true;
                    }
                    return false;
                } catch (error) {
                    console.error('Login error:', error);
                    return false;
                }
            };

            const logout = () => {
                setUser(null);
                localStorage.removeItem('currentUser');
            };

            const register = (userData) => {
                try {
                    const users = DataBackup.loadData('users') || [];
                    
                    if (users.find(u => u.username === userData.username)) {
                        alert('Username already exists');
                        return false;
                    }

                    if (users.find(u => u.email === userData.email)) {
                        alert('Email already exists');
                        return false;
                    }

                    const newUser = {
                        id: Date.now().toString(),
                        ...userData,
                        createdAt: new Date().toISOString()
                    };

                    users.push(newUser);
                    DataBackup.saveData('users', users);
                    
                    const userDataForState = { ...newUser };
                    delete userDataForState.password;
                    setUser(userDataForState);
                    DataBackup.saveData('currentUser', userDataForState);
                    
                    return true;
                } catch (error) {
                    console.error('Registration error:', error);
                    return false;
                }
            };

            const createCompany = (companyData, ownerData) => {
                try {
                    const companies = DataBackup.loadData('companies') || [];
                    const users = DataBackup.loadData('users') || [];
                    
                    if (companies.find(c => c.name === companyData.name)) {
                        alert('Company name already exists');
                        return false;
                    }

                    if (users.find(u => u.username === ownerData.username)) {
                        alert('Username already exists');
                        return false;
                    }

                    if (users.find(u => u.email === ownerData.email)) {
                        alert('Email already exists');
                        return false;
                    }

                    const companyId = Date.now().toString();
                    const ownerId = (Date.now() + 1).toString();

                    const newCompany = {
                        id: companyId,
                        ...companyData,
                        createdAt: new Date().toISOString()
                    };

                    const newOwner = {
                        id: ownerId,
                        ...ownerData,
                        companyId: companyId,
                        role: 'owner',
                        createdAt: new Date().toISOString()
                    };

                    companies.push(newCompany);
                    users.push(newOwner);
                    
                    DataBackup.saveData('companies', companies);
                    DataBackup.saveData('users', users);
                    
                    const userDataForState = { ...newOwner };
                    delete userDataForState.password;
                    setUser(userDataForState);
                    DataBackup.saveData('currentUser', userDataForState);
                    
                    return true;
                } catch (error) {
                    console.error('Company creation error:', error);
                    return false;
                }
            };

            const value = {
                user,
                login,
                logout,
                register,
                createCompany
            };

            return React.createElement(AuthContext.Provider, { value }, children);
        };

        // Login Form Component
        const LoginForm = ({ onLogin }) => {
            const [formData, setFormData] = useState({
                username: '',
                password: ''
            });
            const [isLoading, setIsLoading] = useState(false);

            const handleChange = (e) => {
                setFormData({
                    ...formData,
                    [e.target.name]: e.target.value
                });
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);

                try {
                    const success = onLogin(formData.username, formData.password);
                    if (!success) {
                        alert('Invalid credentials. Please try again.');
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    alert('Login failed. Please try again.');
                } finally {
                    setIsLoading(false);
                }
            };

            const handleDemoLogin = (role) => {
                const demoCredentials = {
                    owner: { username: 'demo-owner', password: 'password' },
                    manager: { username: 'demo-manager', password: 'password' },
                    employee: { username: 'demo-employee', password: 'password' }
                };

                const credentials = demoCredentials[role];
                if (credentials) {
                    setFormData(credentials);
                    onLogin(credentials.username, credentials.password);
                }
            };

            return React.createElement('form', { onSubmit: handleSubmit, className: 'form' },
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'username' }, 'Username'),
                    React.createElement('input', {
                        type: 'text',
                        id: 'username',
                        name: 'username',
                        value: formData.username,
                        onChange: handleChange,
                        required: true,
                        placeholder: 'Enter your username'
                    })
                ),
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'password' }, 'Password'),
                    React.createElement('input', {
                        type: 'password',
                        id: 'password',
                        name: 'password',
                        value: formData.password,
                        onChange: handleChange,
                        required: true,
                        placeholder: 'Enter your password'
                    })
                ),
                React.createElement('button', { 
                    type: 'submit', 
                    className: 'btn btn-primary',
                    disabled: isLoading
                }, isLoading ? 'Signing in...' : 'Sign In'),
                React.createElement('div', { className: 'demo-section' },
                    React.createElement('p', { className: 'demo-label' }, 'Quick Demo Access:'),
                    React.createElement('div', { className: 'demo-buttons' },
                        React.createElement('button', {
                            type: 'button',
                            className: 'btn btn-demo',
                            onClick: () => handleDemoLogin('owner')
                        }, 'Owner Demo'),
                        React.createElement('button', {
                            type: 'button',
                            className: 'btn btn-demo',
                            onClick: () => handleDemoLogin('manager')
                        }, 'Manager Demo'),
                        React.createElement('button', {
                            type: 'button',
                            className: 'btn btn-demo',
                            onClick: () => handleDemoLogin('employee')
                        }, 'Employee Demo')
                    )
                )
            );
        };

        // Register Form Component
        const RegisterForm = ({ onRegister }) => {
            const [formData, setFormData] = useState({
                firstName: '',
                lastName: '',
                username: '',
                email: '',
                password: '',
                confirmPassword: '',
                role: 'employee'
            });
            const [isLoading, setIsLoading] = useState(false);

            const handleChange = (e) => {
                setFormData({
                    ...formData,
                    [e.target.name]: e.target.value
                });
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);

                if (formData.password !== formData.confirmPassword) {
                    alert('Passwords do not match');
                    setIsLoading(false);
                    return;
                }

                if (formData.password.length < 6) {
                    alert('Password must be at least 6 characters long');
                    setIsLoading(false);
                    return;
                }

                try {
                    const userData = {
                        firstName: formData.firstName,
                        lastName: formData.lastName,
                        username: formData.username,
                        email: formData.email,
                        password: formData.password,
                        role: formData.role,
                        companyId: null
                    };

                    const success = onRegister(userData);
                    if (!success) {
                        alert('Registration failed. Username or email may already exist.');
                    }
                } catch (error) {
                    console.error('Registration error:', error);
                    alert('Registration failed. Please try again.');
                } finally {
                    setIsLoading(false);
                }
            };

            return React.createElement('form', { onSubmit: handleSubmit, className: 'form' },
                React.createElement('div', { style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '15px' } },
                    React.createElement('div', { className: 'form-group' },
                        React.createElement('label', { htmlFor: 'firstName' }, 'First Name'),
                        React.createElement('input', {
                            type: 'text',
                            id: 'firstName',
                            name: 'firstName',
                            value: formData.firstName,
                            onChange: handleChange,
                            required: true,
                            placeholder: 'Enter first name'
                        })
                    ),
                    React.createElement('div', { className: 'form-group' },
                        React.createElement('label', { htmlFor: 'lastName' }, 'Last Name'),
                        React.createElement('input', {
                            type: 'text',
                            id: 'lastName',
                            name: 'lastName',
                            value: formData.lastName,
                            onChange: handleChange,
                            required: true,
                            placeholder: 'Enter last name'
                        })
                    )
                ),
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'username' }, 'Username'),
                    React.createElement('input', {
                        type: 'text',
                        id: 'username',
                        name: 'username',
                        value: formData.username,
                        onChange: handleChange,
                        required: true,
                        placeholder: 'Choose a username'
                    })
                ),
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'email' }, 'Email'),
                    React.createElement('input', {
                        type: 'email',
                        id: 'email',
                        name: 'email',
                        value: formData.email,
                        onChange: handleChange,
                        required: true,
                        placeholder: 'Enter your email'
                    })
                ),
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'role' }, 'Role'),
                    React.createElement('select', {
                        id: 'role',
                        name: 'role',
                        value: formData.role,
                        onChange: handleChange,
                        required: true
                    },
                        React.createElement('option', { value: 'employee' }, 'Employee'),
                        React.createElement('option', { value: 'manager' }, 'Manager')
                    )
                ),
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'password' }, 'Password'),
                    React.createElement('input', {
                        type: 'password',
                        id: 'password',
                        name: 'password',
                        value: formData.password,
                        onChange: handleChange,
                        required: true,
                        placeholder: 'Create a password',
                        minLength: 6
                    })
                ),
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'confirmPassword' }, 'Confirm Password'),
                    React.createElement('input', {
                        type: 'password',
                        id: 'confirmPassword',
                        name: 'confirmPassword',
                        value: formData.confirmPassword,
                        onChange: handleChange,
                        required: true,
                        placeholder: 'Confirm your password',
                        minLength: 6
                    })
                ),
                React.createElement('button', { 
                    type: 'submit', 
                    className: 'btn btn-primary',
                    disabled: isLoading
                }, isLoading ? 'Creating Account...' : 'Create Account')
            );
        };

        // Company Registration Component
        const CompanyRegistration = ({ onCompanyRegistration }) => {
            const [step, setStep] = useState(1);
            const [companyData, setCompanyData] = useState({
                name: '',
                industry: 'construction',
                address: '',
                phone: '',
                email: ''
            });
            const [ownerData, setOwnerData] = useState({
                firstName: '',
                lastName: '',
                username: '',
                email: '',
                password: '',
                confirmPassword: ''
            });
            const [isLoading, setIsLoading] = useState(false);

            const industries = [
                { value: 'construction', label: 'Construction' },
                { value: 'healthcare', label: 'Healthcare' },
                { value: 'retail', label: 'Retail' },
                { value: 'manufacturing', label: 'Manufacturing' },
                { value: 'transportation', label: 'Transportation' },
                { value: 'security', label: 'Security' },
                { value: 'cleaning', label: 'Cleaning Services' },
                { value: 'other', label: 'Other' }
            ];

            const handleCompanyChange = (e) => {
                setCompanyData({
                    ...companyData,
                    [e.target.name]: e.target.value
                });
            };

            const handleOwnerChange = (e) => {
                setOwnerData({
                    ...ownerData,
                    [e.target.name]: e.target.value
                });
            };

            const handleNext = () => {
                if (step === 1) {
                    if (!companyData.name || !companyData.industry || !companyData.email) {
                        alert('Please fill in all required company fields');
                        return;
                    }
                    setStep(2);
                }
            };

            const handleBack = () => {
                setStep(1);
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);

                if (ownerData.password !== ownerData.confirmPassword) {
                    alert('Passwords do not match');
                    setIsLoading(false);
                    return;
                }

                if (ownerData.password.length < 6) {
                    alert('Password must be at least 6 characters long');
                    setIsLoading(false);
                    return;
                }

                try {
                    const success = onCompanyRegistration(companyData, {
                        ...ownerData,
                        role: 'owner'
                    });
                    
                    if (!success) {
                        alert('Company registration failed. Username or email may already exist.');
                    }
                } catch (error) {
                    console.error('Company registration error:', error);
                    alert('Company registration failed. Please try again.');
                } finally {
                    setIsLoading(false);
                }
            };

            if (step === 1) {
                return React.createElement('form', { onSubmit: (e) => { e.preventDefault(); handleNext(); }, className: 'form' },
                    React.createElement('div', { className: 'form-group' },
                        React.createElement('label', { htmlFor: 'name' }, 'Company Name *'),
                        React.createElement('input', {
                            type: 'text',
                            id: 'name',
                            name: 'name',
                            value: companyData.name,
                            onChange: handleCompanyChange,
                            required: true,
                            placeholder: 'Enter company name'
                        })
                    ),
                    React.createElement('div', { className: 'form-group' },
                        React.createElement('label', { htmlFor: 'industry' }, 'Industry *'),
                        React.createElement('select', {
                            id: 'industry',
                            name: 'industry',
                            value: companyData.industry,
                            onChange: handleCompanyChange,
                            required: true
                        }, industries.map(industry => 
                            React.createElement('option', { key: industry.value, value: industry.value }, industry.label)
                        ))
                    ),
                    React.createElement('div', { className: 'form-group' },
                        React.createElement('label', { htmlFor: 'address' }, 'Company Address'),
                        React.createElement('input', {
                            type: 'text',
                            id: 'address',
                            name: 'address',
                            value: companyData.address,
                            onChange: handleCompanyChange,
                            placeholder: 'Enter company address'
                        })
                    ),
                    React.createElement('div', { style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '15px' } },
                        React.createElement('div', { className: 'form-group' },
                            React.createElement('label', { htmlFor: 'phone' }, 'Phone Number'),
                            React.createElement('input', {
                                type: 'tel',
                                id: 'phone',
                                name: 'phone',
                                value: companyData.phone,
                                onChange: handleCompanyChange,
                                placeholder: 'Enter phone number'
                            })
                        ),
                        React.createElement('div', { className: 'form-group' },
                            React.createElement('label', { htmlFor: 'email' }, 'Company Email *'),
                            React.createElement('input', {
                                type: 'email',
                                id: 'email',
                                name: 'email',
                                value: companyData.email,
                                onChange: handleCompanyChange,
                                required: true,
                                placeholder: 'Enter company email'
                            })
                        )
                    ),
                    React.createElement('button', { type: 'submit', className: 'btn btn-primary' }, 'Next: Owner Account')
                );
            }

            return React.createElement('form', { onSubmit: handleSubmit, className: 'form' },
                React.createElement('div', { style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '15px' } },
                    React.createElement('div', { className: 'form-group' },
                        React.createElement('label', { htmlFor: 'firstName' }, 'First Name'),
                        React.createElement('input', {
                            type: 'text',
                            id: 'firstName',
                            name: 'firstName',
                            value: ownerData.firstName,
                            onChange: handleOwnerChange,
                            required: true,
                            placeholder: 'Enter first name'
                        })
                    ),
                    React.createElement('div', { className: 'form-group' },
                        React.createElement('label', { htmlFor: 'lastName' }, 'Last Name'),
                        React.createElement('input', {
                            type: 'text',
                            id: 'lastName',
                            name: 'lastName',
                            value: ownerData.lastName,
                            onChange: handleOwnerChange,
                            required: true,
                            placeholder: 'Enter last name'
                        })
                    )
                ),
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'username' }, 'Username'),
                    React.createElement('input', {
                        type: 'text',
                        id: 'username',
                        name: 'username',
                        value: ownerData.username,
                        onChange: handleOwnerChange,
                        required: true,
                        placeholder: 'Choose a username'
                    })
                ),
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'email' }, 'Email'),
                    React.createElement('input', {
                        type: 'email',
                        id: 'email',
                        name: 'email',
                        value: ownerData.email,
                        onChange: handleOwnerChange,
                        required: true,
                        placeholder: 'Enter your email'
                    })
                ),
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'password' }, 'Password'),
                    React.createElement('input', {
                        type: 'password',
                        id: 'password',
                        name: 'password',
                        value: ownerData.password,
                        onChange: handleOwnerChange,
                        required: true,
                        placeholder: 'Create a password',
                        minLength: 6
                    })
                ),
                React.createElement('div', { className: 'form-group' },
                    React.createElement('label', { htmlFor: 'confirmPassword' }, 'Confirm Password'),
                    React.createElement('input', {
                        type: 'password',
                        id: 'confirmPassword',
                        name: 'confirmPassword',
                        value: ownerData.confirmPassword,
                        onChange: handleOwnerChange,
                        required: true,
                        placeholder: 'Confirm your password',
                        minLength: 6
                    })
                ),
                React.createElement('div', { style: { display: 'flex', gap: '12px', justifyContent: 'space-between', marginTop: '24px' } },
                    React.createElement('button', { 
                        type: 'button', 
                        className: 'btn btn-outline',
                        onClick: handleBack
                    }, 'Back'),
                    React.createElement('button', { 
                        type: 'submit', 
                        className: 'btn btn-primary',
                        disabled: isLoading
                    }, isLoading ? 'Creating Company...' : 'Create Company')
                )
            );
        };

        // Main App Component
        const App = () => {
            const [currentView, setCurrentView] = useState('login');
            const [user, setUser] = useState(null);

            useEffect(() => {
                const savedUser = localStorage.getItem('currentUser');
                if (savedUser) {
                    const userData = JSON.parse(savedUser);
                    setUser(userData);
                }
            }, []);

            const handleLogin = (username, password) => {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const foundUser = users.find(u => u.username === username && u.password === password);
                
                if (foundUser) {
                    const userData = { ...foundUser };
                    delete userData.password;
                    setUser(userData);
                    localStorage.setItem('currentUser', JSON.stringify(userData));
                    return true;
                }
                return false;
            };

            const handleRegister = (userData) => {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                
                if (users.find(u => u.username === userData.username)) {
                    alert('Username already exists');
                    return false;
                }

                if (users.find(u => u.email === userData.email)) {
                    alert('Email already exists');
                    return false;
                }

                const newUser = {
                    id: Date.now().toString(),
                    ...userData,
                    createdAt: new Date().toISOString()
                };

                users.push(newUser);
                localStorage.setItem('users', JSON.stringify(users));
                
                const userDataForState = { ...newUser };
                delete userDataForState.password;
                setUser(userDataForState);
                localStorage.setItem('currentUser', JSON.stringify(userDataForState));
                
                return true;
            };

            const handleCompanyRegistration = (companyData, ownerData) => {
                const companies = JSON.parse(localStorage.getItem('companies') || '[]');
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                
                if (companies.find(c => c.name === companyData.name)) {
                    alert('Company name already exists');
                    return false;
                }

                if (users.find(u => u.username === ownerData.username)) {
                    alert('Username already exists');
                    return false;
                }

                if (users.find(u => u.email === ownerData.email)) {
                    alert('Email already exists');
                    return false;
                }

                const companyId = Date.now().toString();
                const ownerId = (Date.now() + 1).toString();

                const newCompany = {
                    id: companyId,
                    ...companyData,
                    createdAt: new Date().toISOString()
                };

                const newOwner = {
                    id: ownerId,
                    ...ownerData,
                    companyId: companyId,
                    role: 'owner',
                    createdAt: new Date().toISOString()
                };

                companies.push(newCompany);
                users.push(newOwner);
                
                localStorage.setItem('companies', JSON.stringify(companies));
                localStorage.setItem('users', JSON.stringify(users));
                
                const userDataForState = { ...newOwner };
                delete userDataForState.password;
                setUser(userDataForState);
                localStorage.setItem('currentUser', JSON.stringify(userDataForState));
                
                return true;
            };

            const handleLogout = () => {
                setUser(null);
                localStorage.removeItem('currentUser');
            };

            if (user) {
                // Simple dashboard based on role
                if (user.role === 'employee') {
                    const [isClockedIn, setIsClockedIn] = useState(false);
                    const [currentTime, setCurrentTime] = useState(new Date().toLocaleTimeString());
                    const [timeEntries, setTimeEntries] = useState([]);
                    const [currentLocation, setCurrentLocation] = useState(null);
                    const [selectedJobSite, setSelectedJobSite] = useState('');
                    const [jobSites, setJobSites] = useState([
                        { id: 1, name: 'Construction Site A', address: '123 Main St' },
                        { id: 2, name: 'Office Building B', address: '456 Oak Ave' },
                        { id: 3, name: 'Warehouse C', address: '789 Pine Rd' }
                    ]);

                    // Update time every second
                    useEffect(() => {
                        const timer = setInterval(() => {
                            setCurrentTime(new Date().toLocaleTimeString());
                        }, 1000);
                        return () => clearInterval(timer);
                    }, []);

                    // Get current location
                    const getCurrentLocation = () => {
                        if (!navigator.geolocation) {
                            alert('Geolocation is not supported by this browser.');
                            return Promise.reject('Geolocation not supported');
                        }

                        return new Promise((resolve, reject) => {
                            navigator.geolocation.getCurrentPosition(
                                (position) => {
                                    const location = {
                                        latitude: position.coords.latitude,
                                        longitude: position.coords.longitude,
                                        accuracy: position.coords.accuracy
                                    };
                                    setCurrentLocation(location);
                                    resolve(location);
                                },
                                (error) => {
                                    console.error('Error getting location:', error);
                                    reject(error);
                                },
                                { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
                            );
                        });
                    };

                    // Capture photo
                    const capturePhoto = () => {
                        return new Promise((resolve, reject) => {
                            const input = document.createElement('input');
                            input.type = 'file';
                            input.accept = 'image/*';
                            input.capture = 'environment';
                            
                            input.onchange = (e) => {
                                const file = e.target.files[0];
                                if (file) {
                                    const reader = new FileReader();
                                    reader.onload = (e) => {
                                        resolve(e.target.result);
                                    };
                                    reader.readAsDataURL(file);
                                } else {
                                    reject('No file selected');
                                }
                            };
                            
                            input.click();
                        });
                    };

                    const handleClockIn = async () => {
                        try {
                            // Get location
                            const location = await getCurrentLocation();
                            
                            // Capture photo
                            const photo = await capturePhoto();
                            
                            const now = new Date();
                            const entry = {
                                id: Date.now(),
                                type: 'clock-in',
                                time: now.toLocaleTimeString(),
                                date: now.toLocaleDateString(),
                                timestamp: now.toISOString(),
                                location: location,
                                photo: photo,
                                jobSite: selectedJobSite || 'No job site selected'
                            };
                            
                            setTimeEntries(prev => [...prev, entry]);
                            setIsClockedIn(true);
                            alert(`Clocked in at ${entry.time}\nLocation: ${location.latitude.toFixed(4)}, ${location.longitude.toFixed(4)}\nJob Site: ${entry.jobSite}`);
                        } catch (error) {
                            console.error('Clock in error:', error);
                            alert('Clock in failed. Please try again.');
                        }
                    };

                    const handleClockOut = async () => {
                        if (!isClockedIn) {
                            alert('You must clock in first!');
                            return;
                        }
                        
                        try {
                            // Get location
                            const location = await getCurrentLocation();
                            
                            // Capture photo
                            const photo = await capturePhoto();
                            
                            const now = new Date();
                            const entry = {
                                id: Date.now(),
                                type: 'clock-out',
                                time: now.toLocaleTimeString(),
                                date: now.toLocaleDateString(),
                                timestamp: now.toISOString(),
                                location: location,
                                photo: photo,
                                jobSite: selectedJobSite || 'No job site selected'
                            };
                            
                            setTimeEntries(prev => [...prev, entry]);
                            setIsClockedIn(false);
                            alert(`Clocked out at ${entry.time}\nLocation: ${location.latitude.toFixed(4)}, ${location.longitude.toFixed(4)}\nJob Site: ${entry.jobSite}`);
                        } catch (error) {
                            console.error('Clock out error:', error);
                            alert('Clock out failed. Please try again.');
                        }
                    };

                    return React.createElement('div', { className: 'container' },
                        React.createElement('div', { className: 'card' },
                            React.createElement('h1', null, `Welcome, ${user.firstName}!`),
                            React.createElement('p', { style: { marginBottom: '20px' } }, `Role: ${user.role}`),
                            
                            React.createElement('div', { style: { 
                                background: '#f8f9fa', 
                                padding: '15px', 
                                borderRadius: '8px', 
                                marginBottom: '20px',
                                textAlign: 'center'
                            } },
                                React.createElement('h3', { style: { margin: '0 0 10px 0' } }, `Current Time: ${currentTime}`),
                                React.createElement('p', { 
                                    style: { 
                                        margin: '0', 
                                        color: isClockedIn ? '#28a745' : '#dc3545',
                                        fontWeight: 'bold'
                                    } 
                                }, isClockedIn ? ' CLOCKED IN' : ' CLOCKED OUT'),
                                currentLocation && React.createElement('p', { 
                                    style: { margin: '5px 0 0 0', fontSize: '12px', color: '#666' } 
                                }, ` Location: ${currentLocation.latitude.toFixed(4)}, ${currentLocation.longitude.toFixed(4)}`)
                            ),
                            
                            React.createElement('div', { style: { marginBottom: '20px' } },
                                React.createElement('label', { 
                                    htmlFor: 'jobSite',
                                    style: { display: 'block', marginBottom: '5px', fontWeight: 'bold' }
                                }, 'Select Job Site:'),
                                React.createElement('select', {
                                    id: 'jobSite',
                                    value: selectedJobSite,
                                    onChange: (e) => setSelectedJobSite(e.target.value),
                                    style: { 
                                        width: '100%', 
                                        padding: '8px', 
                                        borderRadius: '4px', 
                                        border: '1px solid #ccc',
                                        marginBottom: '10px'
                                    }
                                },
                                    React.createElement('option', { value: '' }, 'Select a job site...'),
                                    jobSites.map(site => 
                                        React.createElement('option', { key: site.id, value: site.name }, `${site.name} - ${site.address}`)
                                    )
                                )
                            ),
                            
                            React.createElement('div', { style: { display: 'flex', gap: '10px', marginBottom: '20px' } },
                                React.createElement('button', { 
                                    className: 'btn btn-primary',
                                    onClick: handleClockIn,
                                    disabled: isClockedIn
                                }, isClockedIn ? 'Already Clocked In' : ' Clock In'),
                                React.createElement('button', { 
                                    className: 'btn btn-secondary',
                                    onClick: handleClockOut,
                                    disabled: !isClockedIn
                                }, ' Clock Out')
                            ),
                            
                            React.createElement('div', { style: { marginBottom: '20px' } },
                                React.createElement('h3', null, 'Today\'s Time Entries'),
                                timeEntries.length === 0 ? 
                                    React.createElement('p', null, 'No entries yet - Clock in to start tracking!') :
                                    React.createElement('div', null,
                                        timeEntries.map(entry => 
                                            React.createElement('div', { 
                                                key: entry.id,
                                                style: { 
                                                    padding: '12px', 
                                                    margin: '8px 0', 
                                                    background: entry.type === 'clock-in' ? '#d4edda' : '#f8d7da',
                                                    borderRadius: '6px',
                                                    border: `1px solid ${entry.type === 'clock-in' ? '#c3e6cb' : '#f5c6cb'}`
                                                }
                                            }, 
                                                React.createElement('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center' } },
                                                    React.createElement('div', null,
                                                        React.createElement('strong', null, entry.type === 'clock-in' ? ' Clock In' : ' Clock Out'),
                                                        React.createElement('span', { style: { marginLeft: '10px' } }, `at ${entry.time}`)
                                                    ),
                                                    entry.photo && React.createElement('img', {
                                                        src: entry.photo,
                                                        alt: 'Clock photo',
                                                        style: { width: '40px', height: '40px', borderRadius: '4px', objectFit: 'cover' }
                                                    })
                                                ),
                                                React.createElement('div', { style: { fontSize: '12px', color: '#666', marginTop: '5px' } },
                                                    React.createElement('div', null, ` ${entry.location ? `${entry.location.latitude.toFixed(4)}, ${entry.location.longitude.toFixed(4)}` : 'No location'}`),
                                                    React.createElement('div', null, ` ${entry.jobSite}`)
                                                )
                                            )
                                        )
                                    )
                            ),
                            
                            React.createElement('button', { 
                                className: 'btn btn-outline',
                                onClick: handleLogout
                            }, 'Logout')
                        )
                    );
                } else if (user.role === 'manager') {
                    const [teamMembers, setTeamMembers] = useState([
                        { id: 1, name: 'John Smith', role: 'employee', status: 'clocked-in', lastActivity: '2 hours ago' },
                        { id: 2, name: 'Sarah Johnson', role: 'employee', status: 'clocked-out', lastActivity: '1 hour ago' },
                        { id: 3, name: 'Mike Davis', role: 'employee', status: 'clocked-in', lastActivity: '30 minutes ago' }
                    ]);
                    const [teamStats, setTeamStats] = useState({
                        totalMembers: 3,
                        clockedIn: 2,
                        clockedOut: 1,
                        totalHoursToday: 24.5
                    });

                    return React.createElement('div', { className: 'container' },
                        React.createElement('div', { className: 'card' },
                            React.createElement('h1', null, `Welcome, ${user.firstName}!`),
                            React.createElement('p', { style: { marginBottom: '20px' } }, `Role: ${user.role}`),
                            
                            React.createElement('div', { style: { 
                                display: 'grid', 
                                gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', 
                                gap: '15px', 
                                marginBottom: '30px' 
                            } },
                                React.createElement('div', { 
                                    style: { 
                                        background: '#e3f2fd', 
                                        padding: '15px', 
                                        borderRadius: '8px', 
                                        textAlign: 'center' 
                                    } },
                                    React.createElement('h3', { style: { margin: '0 0 5px 0', color: '#1976d2' } }, teamStats.totalMembers),
                                    React.createElement('p', { style: { margin: '0', fontSize: '14px' } }, 'Total Team Members')
                                ),
                                React.createElement('div', { 
                                    style: { 
                                        background: '#e8f5e8', 
                                        padding: '15px', 
                                        borderRadius: '8px', 
                                        textAlign: 'center' 
                                    } },
                                    React.createElement('h3', { style: { margin: '0 0 5px 0', color: '#2e7d32' } }, teamStats.clockedIn),
                                    React.createElement('p', { style: { margin: '0', fontSize: '14px' } }, 'Currently Clocked In')
                                ),
                                React.createElement('div', { 
                                    style: { 
                                        background: '#fff3e0', 
                                        padding: '15px', 
                                        borderRadius: '8px', 
                                        textAlign: 'center' 
                                    } },
                                    React.createElement('h3', { style: { margin: '0 0 5px 0', color: '#f57c00' } }, `${teamStats.totalHoursToday}h`),
                                    React.createElement('p', { style: { margin: '0', fontSize: '14px' } }, 'Total Hours Today')
                                )
                            ),
                            
                            React.createElement('div', { style: { marginBottom: '20px' } },
                                React.createElement('h3', null, 'Team Members'),
                                React.createElement('div', { style: { marginTop: '15px' } },
                                    teamMembers.map(member => 
                                        React.createElement('div', { 
                                            key: member.id,
                                            style: { 
                                                display: 'flex', 
                                                justifyContent: 'space-between', 
                                                alignItems: 'center',
                                                padding: '12px', 
                                                margin: '8px 0', 
                                                background: member.status === 'clocked-in' ? '#d4edda' : '#f8f9fa',
                                                borderRadius: '6px',
                                                border: `1px solid ${member.status === 'clocked-in' ? '#c3e6cb' : '#dee2e6'}`
                                            }
                                        },
                                            React.createElement('div', null,
                                                React.createElement('strong', null, member.name),
                                                React.createElement('div', { style: { fontSize: '12px', color: '#666' } }, member.role)
                                            ),
                                            React.createElement('div', { style: { textAlign: 'right' } },
                                                React.createElement('span', { 
                                                    style: { 
                                                        color: member.status === 'clocked-in' ? '#28a745' : '#6c757d',
                                                        fontWeight: 'bold',
                                                        fontSize: '12px'
                                                    } 
                                                }, member.status === 'clocked-in' ? ' Clocked In' : ' Clocked Out'),
                                                React.createElement('div', { style: { fontSize: '11px', color: '#999' } }, member.lastActivity)
                                            )
                                        )
                                    )
                                )
                            ),
                            
                            React.createElement('div', { style: { marginBottom: '20px' } },
                                React.createElement('h3', null, 'Quick Actions'),
                                React.createElement('div', { style: { display: 'flex', gap: '10px', flexWrap: 'wrap' } },
                                    React.createElement('button', { 
                                        className: 'btn btn-primary',
                                        onClick: () => alert('Generate team report - Feature coming soon!')
                                    }, ' Generate Report'),
                                    React.createElement('button', { 
                                        className: 'btn btn-secondary',
                                        onClick: () => alert('Send team message - Feature coming soon!')
                                    }, ' Message Team'),
                                    React.createElement('button', { 
                                        className: 'btn btn-outline',
                                        onClick: () => alert('Add team member - Feature coming soon!')
                                    }, ' Add Member')
                                )
                            ),
                            
                            React.createElement('button', { 
                                className: 'btn btn-outline',
                                onClick: handleLogout
                            }, 'Logout')
                        )
                    );
                } else if (user.role === 'owner') {
                    const [companyStats, setCompanyStats] = useState({
                        totalEmployees: 12,
                        totalManagers: 3,
                        activeJobSites: 5,
                        totalHoursThisWeek: 480
                    });
                    const [recentActivity, setRecentActivity] = useState([
                        { id: 1, action: 'New employee hired', user: 'Sarah Johnson', time: '2 hours ago' },
                        { id: 2, action: 'Job site created', user: 'Construction Site D', time: '4 hours ago' },
                        { id: 3, action: 'Manager promoted', user: 'Mike Davis', time: '1 day ago' },
                        { id: 4, action: 'Weekly report generated', user: 'System', time: '2 days ago' }
                    ]);

                    return React.createElement('div', { className: 'container' },
                        React.createElement('div', { className: 'card' },
                            React.createElement('h1', null, `Welcome, ${user.firstName}!`),
                            React.createElement('p', { style: { marginBottom: '20px' } }, `Role: ${user.role}`),
                            
                            React.createElement('div', { style: { 
                                display: 'grid', 
                                gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', 
                                gap: '15px', 
                                marginBottom: '30px' 
                            } },
                                React.createElement('div', { 
                                    style: { 
                                        background: '#e8f5e8', 
                                        padding: '15px', 
                                        borderRadius: '8px', 
                                        textAlign: 'center' 
                                    } },
                                    React.createElement('h3', { style: { margin: '0 0 5px 0', color: '#2e7d32' } }, companyStats.totalEmployees),
                                    React.createElement('p', { style: { margin: '0', fontSize: '14px' } }, 'Total Employees')
                                ),
                                React.createElement('div', { 
                                    style: { 
                                        background: '#e3f2fd', 
                                        padding: '15px', 
                                        borderRadius: '8px', 
                                        textAlign: 'center' 
                                    } },
                                    React.createElement('h3', { style: { margin: '0 0 5px 0', color: '#1976d2' } }, companyStats.totalManagers),
                                    React.createElement('p', { style: { margin: '0', fontSize: '14px' } }, 'Managers')
                                ),
                                React.createElement('div', { 
                                    style: { 
                                        background: '#fff3e0', 
                                        padding: '15px', 
                                        borderRadius: '8px', 
                                        textAlign: 'center' 
                                    } },
                                    React.createElement('h3', { style: { margin: '0 0 5px 0', color: '#f57c00' } }, companyStats.activeJobSites),
                                    React.createElement('p', { style: { margin: '0', fontSize: '14px' } }, 'Active Job Sites')
                                ),
                                React.createElement('div', { 
                                    style: { 
                                        background: '#f3e5f5', 
                                        padding: '15px', 
                                        borderRadius: '8px', 
                                        textAlign: 'center' 
                                    } },
                                    React.createElement('h3', { style: { margin: '0 0 5px 0', color: '#7b1fa2' } }, `${companyStats.totalHoursThisWeek}h`),
                                    React.createElement('p', { style: { margin: '0', fontSize: '14px' } }, 'Hours This Week')
                                )
                            ),
                            
                            React.createElement('div', { style: { marginBottom: '20px' } },
                                React.createElement('h3', null, 'Recent Activity'),
                                React.createElement('div', { style: { marginTop: '15px' } },
                                    recentActivity.map(activity => 
                                        React.createElement('div', { 
                                            key: activity.id,
                                            style: { 
                                                display: 'flex', 
                                                justifyContent: 'space-between', 
                                                alignItems: 'center',
                                                padding: '10px', 
                                                margin: '5px 0', 
                                                background: '#f8f9fa',
                                                borderRadius: '6px',
                                                border: '1px solid #dee2e6'
                                            }
                                        },
                                            React.createElement('div', null,
                                                React.createElement('strong', null, activity.action),
                                                React.createElement('div', { style: { fontSize: '12px', color: '#666' } }, activity.user)
                                            ),
                                            React.createElement('span', { style: { fontSize: '11px', color: '#999' } }, activity.time)
                                        )
                                    )
                                )
                            ),
                            
                            React.createElement('div', { style: { marginBottom: '20px' } },
                                React.createElement('h3', null, 'Data Backup & Management'),
                                React.createElement('div', { style: { display: 'flex', gap: '10px', flexWrap: 'wrap' } },
                                    React.createElement('button', { 
                                        className: 'btn btn-primary',
                                        onClick: () => {
                                            DataBackup.exportAllData();
                                            alert('Backup file downloaded! Save this file in a safe location.');
                                        }
                                    }, ' Export All Data'),
                                    React.createElement('button', { 
                                        className: 'btn btn-secondary',
                                        onClick: () => {
                                            const input = document.createElement('input');
                                            input.type = 'file';
                                            input.accept = '.json';
                                            input.onchange = async (e) => {
                                                const file = e.target.files[0];
                                                if (file) {
                                                    try {
                                                        await DataBackup.importData(file);
                                                        alert('Data imported successfully! Please refresh the page.');
                                                    } catch (error) {
                                                        alert(error);
                                                    }
                                                }
                                            };
                                            input.click();
                                        }
                                    }, ' Import Data'),
                                    React.createElement('button', { 
                                        className: 'btn btn-outline',
                                        onClick: () => {
                                            if (confirm('This will create an automatic backup. Continue?')) {
                                                const users = DataBackup.loadData('users') || [];
                                                const companies = DataBackup.loadData('companies') || [];
                                                const timeEntries = DataBackup.loadData('timeEntries') || [];
                                                const jobSites = DataBackup.loadData('jobSites') || [];
                                                
                                                DataBackup.saveData('manualBackup', {
                                                    users, companies, timeEntries, jobSites,
                                                    timestamp: new Date().toISOString(),
                                                    type: 'manual'
                                                });
                                                alert('Manual backup created successfully!');
                                            }
                                        }
                                    }, ' Create Backup')
                                ),
                                React.createElement('div', { style: { 
                                    background: '#f8f9fa', 
                                    padding: '10px', 
                                    borderRadius: '6px', 
                                    marginTop: '10px',
                                    fontSize: '12px',
                                    color: '#666'
                                } },
                                    React.createElement('p', { style: { margin: '0 0 5px 0' } }, ' Backup Tips:'),
                                    React.createElement('ul', { style: { margin: '0', paddingLeft: '20px' } },
                                        React.createElement('li', null, 'Export data regularly and store in multiple locations'),
                                        React.createElement('li', null, 'Data is automatically backed up every 5 minutes'),
                                        React.createElement('li', null, 'Data is stored in localStorage, sessionStorage, and IndexedDB'),
                                        React.createElement('li', null, 'For production use, implement cloud backup (see documentation)')
                                    )
                                )
                            ),
                            
                            React.createElement('button', { 
                                className: 'btn btn-outline',
                                onClick: handleLogout
                            }, 'Logout')
                        )
                    );
                } else {
                    return React.createElement('div', { style: { padding: '20px', textAlign: 'center' } },
                        React.createElement('h1', null, `Welcome, ${user.firstName}!`),
                        React.createElement('p', { style: { marginBottom: '20px' } }, `Role: ${user.role}`),
                        React.createElement('button', { 
                            className: 'btn btn-outline',
                            onClick: handleLogout
                        }, 'Logout')
                    );
                }
            }

            return React.createElement('div', { className: 'container' },
                React.createElement('div', { className: 'login-card' },
                    React.createElement('div', { className: 'logo' }, ''),
                    React.createElement('h1', null, 'TimeTracker'),
                    React.createElement('p', { className: 'subtitle' }, 'Multi-Company Location-Based Timesheet Platform'),
                    
                    React.createElement('div', { className: 'tab-container' },
                        React.createElement('button', { 
                            className: `tab ${currentView === 'login' ? 'active' : ''}`,
                            onClick: () => setCurrentView('login')
                        }, 'Login'),
                        React.createElement('button', { 
                            className: `tab ${currentView === 'register' ? 'active' : ''}`,
                            onClick: () => setCurrentView('register')
                        }, 'Register'),
                        React.createElement('button', { 
                            className: `tab ${currentView === 'company' ? 'active' : ''}`,
                            onClick: () => setCurrentView('company')
                        }, 'Start Company')
                    ),

                    currentView === 'login' && React.createElement(LoginForm, { onLogin: handleLogin }),
                    currentView === 'register' && React.createElement(RegisterForm, { onRegister: handleRegister }),
                    currentView === 'company' && React.createElement(CompanyRegistration, { onCompanyRegistration: handleCompanyRegistration })
                )
            );
        };

        // Start automatic backup system
        DataBackup.startAutoBackup();
        console.log('Automatic backup system started (every 5 minutes)');
        
        // Render the app
        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(AuthProvider, null, React.createElement(App)));
    </script>
</body>
</html>

